# Анализ текущего состояния UI проекта PPSD

## Обзор архитектуры интерфейса

PPSD использует PySide6 (Qt6) для создания десктопного приложения с системой ролей и модульной архитектурой.

### Текущая структура UI:

```
ui/
├── main_window.py          # Главное окно с вкладками по ролям
├── dashboard.py            # Дашборд с аналитикой  
├── login_window.py         # Окно входа в систему
├── styles.py              # Стили (требует рефакторинга)
├── themes.py              # Система тем (базовая реализация)
├── notifications.py       # Система уведомлений
├── tabs/                  # Вкладки по функциональности
│   ├── warehouse_tab.py   # Управление складом
│   ├── qc_tab.py         # Контроль качества  
│   ├── lab_tab.py        # Лаборатория
│   ├── admin_tab.py      # Администрирование
│   └── production_tab.py # Производство
├── dialogs/              # Диалоговые окна
│   ├── qr_dialog.py
│   ├── certificate_browser_dialog.py
│   └── ...
└── components/           # Переиспользуемые компоненты
    ├── charts.py
    ├── advanced_search.py
    └── ...
```

## Выявленные проблемы

### 1. Масштабирование и адаптивность
- **Проблема**: Фиксированные размеры виджетов (`setFixedWidth`, `setFixedHeight`)
- **Локация**: `ui/styles.py`, `ui/tabs/*.py`
- **Влияние**: Интерфейс не адаптируется к разным экранам и DPI

### 2. Система стилей
- **Проблема**: Inline стили в Python коде вместо QSS файлов
- **Локация**: `ui/styles.py`, компоненты таблиц
- **Влияние**: Сложность поддержки, отсутствие централизованного управления темами

### 3. Таблицы и списки
- **Проблема**: Столбцы не растягиваются, фиксированная ширина
- **Локация**: `ui/tabs/warehouse_tab.py`, `ui/tabs/qc_tab.py`, `ui/tabs/lab_dialogs.py`
- **Влияние**: Плохая читаемость на широких экранах, скролл

### 4. Layout система
- **Проблема**: Недостаточное использование гибких layout'ов
- **Локация**: Все UI компоненты
- **Влияние**: Негибкость интерфейса при изменении размеров

### 5. Система тем
- **Проблема**: Базовая реализация, нет полноценной поддержки светлой/темной темы
- **Локация**: `ui/themes.py`
- **Влияние**: Ограниченные возможности кастомизации

## Приоритетные файлы для рефакторинга

### Высокий приоритет:
1. `ui/main_window.py` - главное окно
2. `ui/styles.py` - система стилей
3. `ui/themes.py` - система тем
4. `ui/dashboard.py` - главная страница

### Средний приоритет:
1. `ui/tabs/warehouse_tab.py` - склад (основная функциональность)
2. `ui/tabs/qc_tab.py` - контроль качества
3. `ui/tabs/lab_dialogs.py` - лабораторные диалоги

### Низкий приоритет:
1. `ui/dialogs/*` - диалоговые окна
2. `ui/components/*` - компоненты

## Рекомендуемый план рефакторинга

### Этап 1: Создание QSS системы
1. Создать `resources/styles/dark.qss`
2. Создать `resources/styles/light.qss`  
3. Обновить `ui/themes.py` для загрузки QSS

### Этап 2: Исправление масштабирования
1. Убрать все `setFixed*` методы
2. Добавить `setSizePolicy` с гибкими параметрами
3. Настроить растяжение таблиц

### Этап 3: Переработка layout'ов
1. Заменить фиксированные layout на гибкие
2. Добавить `QSpacerItem` для выравнивания
3. Использовать `QSplitter` для разделения областей

### Этап 4: Новый дизайн главной страницы
1. Выбрать UX паттерн (Dashboard/Sidebar/Ribbon)
2. Реализовать современный дизайн
3. Добавить адаптивность

## Технические требования

### Поддерживаемые разрешения:
- 1920x1080 (Full HD)
- 2560x1440 (2K)
- 3840x2160 (4K)
- Различные DPI (100%, 125%, 150%, 200%)

### Браузеры/Системы:
- Windows 10/11
- Опционально: Linux, macOS

### PySide6 версия:
- Минимум: 6.5.0
- Рекомендуется: 6.9.0+

## Примеры проблемного кода

### Фиксированные размеры в таблицах:
```python
# Проблемный код в ui/styles.py
table.setMinimumWidth(50)
table.setFixedWidth(50)

# Нужно заменить на:
table.setSizePolicy(QSizePolicy.Expanding, QSizePolicy.Expanding)
table.horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
```

### Inline стили:
```python
# Проблемный код
button.setStyleSheet('''
    QPushButton {
        font-size: 14px;
        padding: 8px 18px;
        border-radius: 6px;
        color: #222;
        background: #f8f8f8;
    }
''')

# Нужно вынести в QSS файл
```

### Отсутствие растяжек в layout:
```python
# Проблемный код
layout = QHBoxLayout()
layout.addWidget(widget1)
layout.addWidget(widget2)

# Нужно добавить растяжки:
layout = QHBoxLayout()
layout.addStretch()
layout.addWidget(widget1)
layout.addWidget(widget2)
layout.addStretch()
```

---

**Заключение**: Требуется комплексный рефакторинг UI с фокусом на адаптивность, модульность стилей и современный UX дизайн. 