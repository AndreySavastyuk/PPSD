# Миграция ППСД с PyQt5 на PySide6 (Qt6)

## Зачем миграция?

- **Современные технологии**: Qt6 предлагает улучшенный рендеринг, лучшую поддержку HiDPI и множество новых функций
- **Долгосрочная поддержка**: Qt5 постепенно устаревает, Qt6 будет поддерживаться долгие годы
- **Лицензия**: PySide6 (LGPL) предлагает более гибкую лицензию по сравнению с PyQt5 (GPL)
- **Исправление текущих проблем**: Миграция позволит решить существующие проблемы с интерфейсом

## Готовые инструменты для миграции

В репозитории добавлены следующие инструменты для автоматизации процесса:

1. **scripts/migrate_to_qt6.py** - скрипт для автоматической миграции кода
   - Обновляет импорты с PyQt5 на PySide6
   - Обновляет константы Qt (например, Qt.AlignCenter → Qt.AlignmentFlag.AlignCenter)
   - Адаптирует метод app.exec_() → app.exec()

2. **docs/migration_checklist.md** - подробный чек-лист для миграции
   - Шаги подготовки
   - Автоматизированная миграция
   - Ручная проверка и доработка
   - Тестирование

3. **scripts/test_qt6_icons.py** - тестовый скрипт для проверки иконок в Qt6
   - Позволяет проверить, что иконки корректно отображаются
   - Демонстрирует адаптированный для Qt6 код отрисовки

4. **docs/qt6_icons_example.py** - пример реализации IconProvider для Qt6
   - Референсная версия модуля icon_provider.py для Qt6

5. **docs/migrated_main_window_sample.py** - пример полностью мигрированного окна
   - Референсная версия main_window.py для Qt6

## Пошаговая инструкция миграции

### 1. Подготовка

```bash
# Создать ветку для миграции
git checkout -b qt6-migration

# Создать резервную копию проекта
cp -r PPSD PPSD_BACKUP

# Установить PySide6
pip install PySide6==6.5.2

# Обновить requirements.txt (или использовать скрипт)
```

### 2. Автоматическая миграция

```bash
# Запустить скрипт миграции
python scripts/migrate_to_qt6.py

# Проверить лог выполнения скрипта
```

### 3. Ручная проверка и доработка

- Проверить файлы, выведенные в отчете скрипта миграции
- Особое внимание уделить модулю icon_provider.py
- Проверить все диалоги и формы

### 4. Тестирование

```bash
# Проверить иконки
python scripts/test_qt6_icons.py

# Запустить основное приложение
python main.py
```

### 5. Завершение миграции

- Убедиться, что все проблемы решены
- Закоммитить изменения
- Слить ветку в основную

## Возможные проблемы и их решение

1. **Проблема:** Не отображаются иконки
   **Решение:** Проверить использование констант Qt в модуле icon_provider.py

2. **Проблема:** Не работают диалоговые окна
   **Решение:** Проверить использование констант QMessageBox.StandardButton

3. **Проблема:** Ошибки при запуске приложения
   **Решение:** Проверить все импорты и убедиться, что app.exec_() заменен на app.exec()

4. **Проблема:** Не выравниваются элементы форм
   **Решение:** Проверить константы выравнивания (Qt.AlignmentFlag)

## Дополнительные ресурсы

- [Официальная документация по миграции на Qt6](https://doc.qt.io/qt-6/porting-to-qt6.html)
- [PySide6 Documentation](https://doc.qt.io/qtforpython-6/index.html)
- [Qt6 API Reference](https://doc.qt.io/qt-6/qtmodules.html)

## Специфические изменения для ППСД

1. **icon_provider.py**
   - Обновить константы Qt.transparent → Qt.GlobalColor.transparent
   - Обновить константы QPainter.Antialiasing → QPainter.RenderHint.Antialiasing

2. **main_window.py**
   - Обновить константы QFrame.HLine → QFrame.Shape.HLine
   - Обновить диалоги QMessageBox

3. **reference/\*.py**
   - Проверить работу диалоговых окон
   - Проверить отображение таблиц

4. **warehouse_entry_form.py**
   - Проверить работу диалогов размеров
   - Проверить расчеты веса

## Контрольные точки миграции

- [x] Создание документации
- [x] Создание инструментов миграции
- [ ] Автоматическая миграция импортов
- [ ] Ручная проверка и доработка
- [ ] Тестирование
- [ ] Развертывание 