# PPSD (Производственная Программа Складского Документооборота)

## Описание проекта

PPSD - это комплексная система для управления складским документооборотом, специализирующаяся на работе с сертификатами качества, отчетами о тестировании и движениями материалов. Система предназначена для металлургических предприятий и позволяет отслеживать металлические изделия от поступления на склад до отправки заказчику, включая все промежуточные этапы контроля качества.

## Технологический стек

* **Язык программирования**: Python 3.12
* **Графический интерфейс**: PySide6 (Qt6)
* **База данных**: SQLite с SQLAlchemy ORM
* **Генерация отчетов**: ReportLab, PDFKit
* **Планировщик задач**: APScheduler
* **Веб-интерфейс**: FastAPI (опционально)
* **Дополнительные библиотеки**: python-dotenv, qrcode, python-telegram-bot

## Структура проекта

```
PPSD/
├── database/                   # Модули для работы с БД
│   ├── connection.py          # Настройка соединений с БД
│   ├── init_db.py            # Инициализация структуры БД
│   └── migrate_db.py         # Скрипты миграции БД
│
├── docs/                      # Документация проекта
│   ├── PROJECT_SPECIFICATION.md  # Техническое задание
│   ├── QT6_MIGRATION_README.md   # Руководство по миграции на Qt6
│   ├── improvements.md           # Описание улучшений
│   ├── lab_samples_feature.md    # Функциональность лабораторных образцов
│   └── migration_checklist.md   # Чек-лист миграции
│
├── docs_storage/              # Хранилище документов (исключено из git)
│   ├── certificates/         # Сертификаты качества материалов
│   ├── sample_requests/      # Заявки на испытания образцов
│   └── test_reports/         # Отчеты о проведенных испытаниях
│
├── examples/                  # Примеры использования
│   └── example_usage.py      # Примеры API и основных функций
│
├── logs/                      # Логи системы (исключено из git)
│
├── models/                    # Модели данных
│   └── models.py             # Определения моделей SQLAlchemy
│
├── scripts/                   # Вспомогательные скрипты
│   ├── migrations/           # Скрипты для миграции данных
│   │   ├── add_samples_tables.py
│   │   └── update_sample_requests.py
│   ├── init_db.py           # Инициализация БД
│   ├── migrate_to_qt6.py    # Миграция на Qt6
│   ├── run_migrations.py    # Запуск миграций
│   └── update_db*.py        # Скрипты обновления БД
│
├── ui/                        # Компоненты интерфейса
│   ├── components/           # Переиспользуемые компоненты
│   │   ├── advanced_search.py    # Расширенный поиск
│   │   ├── backup_system.py      # Система резервного копирования
│   │   ├── charts.py            # Графики и диаграммы
│   │   ├── export_system.py     # Система экспорта данных
│   │   └── real_time_notifications.py  # Уведомления в реальном времени
│   │
│   ├── dialogs/              # Диалоговые окна
│   │   ├── advanced_search_dialog.py  # Диалог расширенного поиска
│   │   ├── audit_log_dialog.py       # Просмотр журнала аудита
│   │   ├── certificate_browser_dialog.py  # Браузер сертификатов
│   │   ├── qr_dialog.py             # Генератор QR-кодов
│   │   └── status_change_dialog.py  # Изменение статуса
│   │
│   ├── icons/                # Иконки и графические ресурсы
│   │   └── icon_provider.py  # Провайдер иконок
│   │
│   ├── reference/            # Окна справочников (из старой версии)
│   │
│   ├── tabs/                 # Основные вкладки приложения
│   │   ├── admin_tab.py         # Вкладка администрирования
│   │   ├── lab_dialogs.py       # Диалоги лаборатории
│   │   ├── lab_tab.py           # Вкладка лаборатории
│   │   ├── lab_test_detail.py   # Детали лабораторных тестов
│   │   ├── production_tab.py    # Вкладка производства
│   │   ├── qc_tab.py           # Вкладка ОТК
│   │   ├── sample_management_dialog.py  # Управление образцами
│   │   ├── warehouse_entry_form.py      # Форма складских записей
│   │   └── warehouse_tab.py             # Вкладка склада
│   │
│   ├── dashboard.py          # Главная панель (дашборд)
│   ├── login_window.py       # Окно входа в систему
│   ├── main_window.py        # Главное окно приложения
│   ├── notifications.py     # Система уведомлений
│   ├── styles.py            # Стили интерфейса
│   └── themes.py            # Темы оформления
│
├── utils/                     # Вспомогательные функции
│   ├── audit.py              # Система аудита действий
│   ├── auth.py               # Аутентификация пользователей
│   ├── certificate_manager.py # Управление сертификатами
│   ├── excel_export.py       # Экспорт в Excel
│   ├── file_utils.py         # Работа с файлами
│   └── material_utils.py     # Утилиты для работы с материалами
│
├── venv/                      # Виртуальное окружение (исключено из git)
│
├── web-app/                   # Веб-приложение (опционально)
│   ├── backend/              # Backend на FastAPI
│   └── templates/            # HTML шаблоны
│
├── .env                       # Переменные окружения (исключено из git)
├── .gitignore                # Файлы, исключенные из репозитория
├── .pre-commit-config.yaml   # Конфигурация pre-commit хуков
├── api.py                    # API сервер на FastAPI
├── fix_admin_password.py     # Скрипт сброса пароля администратора
├── main.py                   # Точка входа в приложение
├── requirements.txt          # Зависимости проекта
├── requirements_web.txt      # Зависимости для веб-части
├── start_web_services.py     # Запуск веб-сервисов
└── README.md                 # Этот файл

```

## Основные функции

### 1. Управление складом
- Учет поступлений, перемещений и отгрузок материалов
- Отслеживание партий и плавок
- Контроль остатков на складе
- История движений материалов

### 2. Работа с сертификатами
- Хранение и категоризация сертификатов качества
- Поиск сертификатов по различным критериям
- Автоматическое сопоставление сертификатов с материалами
- Браузер сертификатов с предварительным просмотром

### 3. Лабораторные испытания
- Регистрация заявок на образцы
- Отслеживание процесса тестирования
- Документирование результатов испытаний
- Автоматическая генерация отчетов

### 4. Система пользователей и ролей
- **Администратор**: Полный доступ ко всем функциям
- **Кладовщик**: Управление складскими операциями
- **ОТК**: Контроль качества продукции
- **Лаборатория**: Управление испытаниями
- **Производство**: Просмотр производственной информации

### 5. Отчетность и аналитика
- Генерация отчетов о движении материалов
- Статистика по результатам испытаний
- Дашборд с ключевыми показателями
- Экспорт данных в Excel

### 6. Интеграция и автоматизация
- API для интеграции с внешними системами
- Планировщик автоматических задач
- Система уведомлений
- QR-коды для быстрого доступа к информации

## Установка и запуск

1. **Клонировать репозиторий:**
```bash
git clone https://github.com/AndreySavastyuk/PPSD.git
cd PPSD
```

2. **Создать и активировать виртуальное окружение:**
```bash
python -m venv venv
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate
```

3. **Установить зависимости:**
```bash
pip install -r requirements.txt
```

4. **Настроить переменные окружения:**
```bash
# Создать файл .env со следующими параметрами
DATABASE_PATH=database/ppsd.db
DOCUMENTS_PATH=docs_storage/
```

5. **Инициализировать базу данных:**
```bash
python scripts/init_db.py
```

6. **Запустить приложение:**
```bash
python main.py
```

## Веб-интерфейс (опционально)

Для запуска веб-сервисов:

```bash
# Установить веб-зависимости
pip install -r requirements_web.txt

# Запустить веб-сервисы
python start_web_services.py
```

API будет доступен по адресу: http://localhost:8000  
Документация API: http://localhost:8000/docs

## Тестирование

Для тестирования системы доступны следующие скрипты:

- `test_admin_login.py` - проверка входа администратора
- `test_certificate_browser.py` - тестирование браузера сертификатов
- `test_icons.py` - проверка системы иконок
- `test_improvements.py` - тестирование улучшений
- `fix_admin_password.py` - сброс пароля администратора

## Разработка и контрибьютинг

Проект находится в активной разработке. Текущие приоритеты:

1. ✅ Миграция с Qt5 на Qt6 (PySide6)
2. ✅ Улучшение работы с сертификатами качества
3. ✅ Оптимизация процесса лабораторных испытаний
4. ✅ Расширение функциональности отчетов
5. 🔄 Веб-интерфейс на FastAPI
6. 🔄 Мобильное приложение
7. 🔄 Интеграция с внешними системами

## Технические особенности

### Архитектура
- **MVC-паттерн**: Разделение логики, данных и представления
- **Модульная структура**: Каждый компонент в отдельном модуле
- **Система тем**: Поддержка светлой и темной темы
- **Плагинная архитектура**: Возможность расширения функциональности

### База данных
- **SQLAlchemy ORM**: Объектно-реляционное отображение
- **Миграции**: Автоматическое обновление схемы БД
- **Связи**: Правильно настроенные связи между таблицами
- **Индексы**: Оптимизация производительности запросов

### Пользовательский интерфейс
- **PySide6**: Современный и быстрый интерфейс
- **Адаптивность**: Поддержка разных разрешений экрана
- **Темы**: Светлая и темная тема
- **Иконки**: Векторные иконки для всех элементов

## Лицензия

Проект распространяется под лицензией MIT. Подробнее в файле LICENSE.

## Контакты

**Андрей Савастюк** - savastyukowl@gmail.com

Ссылка на проект: [https://github.com/AndreySavastyuk/PPSD](https://github.com/AndreySavastyuk/PPSD) 